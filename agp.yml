# AGP Configuration for nextjs-app
# Complete configuration with defaults and customizations

version: "1"

# ━━━ API Configuration ━━━
# Backend API for tracking and recommendations
api:
  # url and token are set via env vars: AGP_API_URL, AGP_API_TOKEN
  # url: "https://guide-dev.sonatype.com"
  # token: "your-token"

# ━━━ Agent Configuration ━━━
# AI-powered fixes for validation failures
agent:
  enabled: true                          # Enable AI agent
  provider: "anthropic"                  # AI provider (default: anthropic)
  model: "claude-sonnet-4-20250514"      # Model to use
  maxIterations: 10                      # Max agent loops per fix
  maxFixAttempts: 3                      # Max fix attempts per group
  apiKeyEnv: "ANTHROPIC_API_KEY"        # Env var for API key
  # baseUrl: "https://api.anthropic.com" # Custom API endpoint (optional)
  timeout: "30m"                         # Agent timeout
  maxTokens: 100000                      # Max tokens per fix attempt
  warnTokensAt: 50000                    # Warn when exceeding this

# ━━━ Validation Configuration ━━━
# Commands to run after applying updates
validation:
  enabled: true                          # Enable validation to test agent fixes
  commands:
    - npm run build
  timeout: "10m"                         # Validation timeout

# ━━━ Pull Request Configuration ━━━
# Configuration for created PRs
pr:
  # titleTemplate: "Update {{packages}}"  # Custom PR title (optional)
  # bodyTemplate: "..."                   # Custom PR body (optional)
  draft: true                             # Create PRs as drafts
  labels:                                 # Labels to add to PRs
    - dependencies
    - automated
  # reviewers:                            # Auto-assign reviewers (optional)
  #   - "@team/reviewers"
  # branchTemplate: "agp/{{type}}/{{id}}" # Custom branch naming (optional)

# ━━━ Ignore Configuration ━━━
# Packages or paths to exclude from updates
ignore:
  packages: []                            # Packages to never update
  # packages:
  #   - "typescript"                      # Example: pin TypeScript version
  #   - "@types/*"                        # Example: ignore all @types
  paths: []                               # Paths to ignore
  # paths:
  #   - "examples/**"
  #   - "docs/**"

# ━━━ Grouping Configuration ━━━
# How to group dependency updates
grouping:
  strategy: "smart"                       # smart, manual, or all-together
  # rules:                                # Custom grouping rules (optional)
  #   - name: "React ecosystem"
  #     match:
  #       - "react"
  #       - "react-dom"
  #       - "@types/react"
  #     strategy: "together"
